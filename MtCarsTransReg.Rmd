Fuel Economy and Analysis of Motor Trend Data Transmissions
========================================================

## Executive Summary

The contribution of automatic or manual transmissions (AM) to miles per gallon (MPG) was analyzed using the 1974 _Motor Trend Magazine_ data of 11 variables on 32 automobiles.  The resulting analysis of the _mtcars_ dataset in the standard R datasets package indicate:

- Cars with manual transmissions had better MPGs than automatic transmissions
- Holding all other variables constant, cars with manual transmissions had 7.25 MPG better fuel economy
- There were several confounding variables including weight in lbs/1000 and quarter mile time in seconds which were included in the final model in addition to transmission type
- The final model explained nearly 0.85 of the variance as described by the $R^2$ value
- In the final model including these additional variables, manual transmissions had better mileage but only about 2.9 MPG different than automatic transmission cars holding all other variables constant

## Data Transformation and Exploration

Several of the 11 variables in the dataset were initially numeric and had to be transformed into factor variables to be appropriately analyzed.

```{r echo=TRUE, results='hide'}
library(car)
mtcars <- datasets::mtcars  # start with the baseline data from the datasets package
mtcars$am <- factor(mtcars$am, levels=c(0,1), labels=c("Automatic","Manual"))
mtcars$cyl <- factor(mtcars$cyl); mtcars$vs <- factor(mtcars$vs)
```
As can be seen in __Appendix Figure 1__, considering no other variables, there is a significant difference in MPG based on transmission type.

## Linear Models and Selection
__Base model:__
A baseline model was initially developed using just transmission type for an independent variable and MPG as the dependent.
```{r baselm, highlight=TRUE, echo=FALSE}
(summaryBaselm <- summary(baselm <- lm(mpg ~ am, data=mtcars)))
(ciBaselm <- confint(baselm))  # confidence intervals of the coefficients
```
As can be seen, with no other variables there is a statistically significant difference of `r baselm$coefficients[2]` increase in MPG for manual transmissions (p=`r sprintf("%f", coef(summaryBaselm)[2,4])`, conf interval= (`r ciBaselm[2,1]` to `r ciBaselm[2,2]`)). However, the model only explains `r summary(baselm)$r.squared` of the variance in mpg based on the $R^2$ value. (Residual tests of this model may be found in __Appendix Figure 3__.)

__Alternate model:__ However, in reviewing other parameters in the dataset, it was determined that including only the transmission type created a bias model.  We created several models using the _step()_ function and looked at the significance of comparing models using ANOVA tests, and the variance inflation to find a more parsimonious, interpretable representation.  We also looked at outliers using _hatvalues_ function and _dfbetas_ on the most significant model to see if any of the model coefficients were significantly influence by specific outlier values.

```{r findBest, results='hide', echo=TRUE}
summaryBestlm <- summary(bestlm <- step(lm(mpg ~ ., data=mtcars)))
```
```{r bestlmDisplay, echo=FALSE}
summaryBestlm 
anova (baselm, bestlm)
```
It was determined that a model using transmission type, quarter mile time in seconds, and weight in lbs/1000 had a significantly better result (p-value for each coefficient < 0.05, $R^2$ = `r summaryBestlm$r.squared`) and was statistically significantly better than the base model based on anova tests (p = 1.6e-9). The confidence interval for manual transmissions was reduced to `r coef(summaryBestlm)[4,1]` (conf interval = `r confint(bestlm)[4,1]` to `r confint(bestlm)[4,2]`) with these additional parameters added to the model.  The residual tests of this new model are available in __Appendix Figure 4__.

## Conclusions

Taken on its own, manual transmission cars would save on average `r coef(summaryBaselm)[2,1]` MPG if it was the only modeled independent variable.  However, a significantly better model with quarter mile time, weight and transmission type would explain about `r summaryBestlm$r.squared` of the variance in MPG.  Holding quarter mile time and weight constant, this model results in manual transmissions having `r coef(summaryBestlm)[4,1]` MPG better than automatic transmissions.



## Appendix

The following information is available as an appendix for review or reference.

```{r fig.width=5, fig.height=5, echo=FALSE}
plot(mpg ~ am, mtcars, col="red",
     xlab="Transmission Type", ylab="Miles per Gallon",
     main="MPG by Transmission")
```
Figure 1: Automatic vs. Manual transmissions and Miles per Gallon with no other variables

```{r}
summary(mtcars)
```
Figure 2: Summary of mtcars data used for analysis

```{r residualsBase, fig.width=7, fig.height=6, echo=FALSE}
par(mfrow=c(2,2))
plot(baselm, main="Residual Analysis of Base Model")
```
Figure 3: Residuals analysis of base model including just mpg and transmission type


```{r residualsBest, fig.width=7, fig.height=6, echo=FALSE}
par(mfrow=c(2,2))
plot(bestlm, main="Residual Analysis of Best Model")
```
Figure 4: Residuals analysis of best model including mpg, weight, quarter mile time and transmission type


### Exploring aternate models

fitAll <- lm(mpg ~ ., data=mtcars)  # no good
summary(fitAll)
vif(fitAll)

(summaryBest2lm <- summary(best2lm <- lm(mpg ~ am + hp, data=mtcars)))
anova (baselm, best2lm)


(summaryBestlm <- summary(bestlm <- lm(mpg ~ am + hp + wt, data=mtcars)))
anova (baselm, bestlm)

(summaryBestNoAMlm <- summary(bestNoAMlm <- lm(mpg ~ hp + wt, data=mtcars)))
anova (baselm, bestNoAMlm)

# Note AM and HP leaves AM signifcant and explains 78% variance.


